# Ь Backend - Sistema de Gesti贸n de ptica

Sistema backend desarrollado en Django para gesti贸n de ventas, inventario y facturaci贸n electr贸nica.

---

##  Datos de Prueba Precargados

El proyecto incluye **migraciones autom谩ticas** que cargan datos de prueba para desarrollo acutalmente para verificar el funcionamiento del sistena

# Resumen de Cambios - Datos de Prueba


### Migraciones de Django (6 archivos)

1. **Branch/migrations/0005_load_sample_branches.py**
   - Carga 5 sucursales de prueba
   - Incluye funci贸n de reversi贸n

2. **User/migrations/0011_load_sample_users.py**
   - Carga 8 usuarios con diferentes roles
   - Contrase帽a hasheada: 2025
   - Incluye funci贸n de reversi贸n

3. **suppliers/migrations/0003_load_sample_suppliers.py**
   - Carga 6 proveedores
   - RUCs v谩lidos
   - Incluye funci贸n de reversi贸n

4. **clients/migrations/0004_load_sample_clients.py**
   - Carga 10 clientes
   - DNI y CE v谩lidos
   - Incluye funci贸n de reversi贸n

5. **inventory/migrations/0009_load_sample_products.py**
   - Carga 10 categor铆as de productos
   - 14 productos (10 globales, 4 locales)
   - Inventario distribuido en 3 sucursales
   - Incluye funci贸n de reversi贸n

6. **cash/migrations/0003_load_sample_cash_data.py**
   - Carga 4 cajas registradoras
   - 5 aperturas de caja
   - Incluye funci贸n de reversi贸n



### Datos Disponibles

- 5 sucursales en Arequipa, Lima y Cusco
- 8 usuarios con roles diferentes (admin, cajeros, vendedores, etc.)
- 6 proveedores de marcas reconocidas
- 10 clientes de ejemplo
- 14 productos con precios e inventario
- 4 cajas con aperturas activas

##  Credenciales
**Otros usuarios:**
- cajero1, cajero2, vendedor1, vendedor2, optometra1, supervisor1, logistica1
- Todos con password: `2025`


### Migraciones Django
```bash
cd backend
python manage.py migrate
```

## Reversi贸n

Para eliminar datos de prueba:
```bash
python manage.py migrate Branch 0004
python manage.py migrate User 0010
# etc...
```

- Solo para desarrollo y pruebas
- SQLite por defecto
- Compatible con PostgreSQL (usar database_setup.sql)
- Las migraciones tienen dependencias correctas
- Incluyen funciones de reversi贸n


## Ь Registro de usuarios v铆a Postman (Alternativo)

Gu铆a para crear usuarios manualmente usando Postman.

###  Pasos para registrarse

### 1. Instalar Postman

Descarga la extensi贸n postman

---

### 2. Crear un nuevo request

- M茅todo: `POST`  
- URL del endpoint:   http://127.0.0.1:8000/api/user/new/

---

### 3. Enviar el siguiente JSON en el cuerpo

Selecciona `Body > raw > JSON` y pega:

```json
{
  "usuNom": "FabianaPelotita",
  "usuEmail": "fabiana@example.com",
  "usuTel": "987654321",
  "usuNombreCom": "Fabiana Francinet Pacheco Palo",
  "usuDNI": "12345678",
  "usuContra": "2025",
  "roles": [1]
}
```
# Cajas con postman 

Gu铆a para que abran y cierren caja, se asigna automaticamente la sucursal del token en sucurCod 
# Crear Caja
POST http://localhost:8000/api/cash/
```json
{
  "sucurCod": 1,
  "usuCod": 2,
  "cajNom": "Caja Principal Arequipa",
  "cajDes": "Caja ubicada en el mostrador principal",
  "cajEstado": "ACTIVO"
}
```
# Abrir caja asegurate que seas el usuario asignado, token del usuario asignado
POST http://localhost:8000/api/cash/opening/
```json
{
  "sucurCod": 1,
  "cajCod": 1,
  "cajaAperMontInicial": 150.00,
  "cajaAperObservacio": "Inicio de turno tarde"
}
```
# cerrar caja
POST http://localhost:8000/api/cash/opening/1/cerrar
```json
{
  "cajaAperMontCierre": 152.00
}
```